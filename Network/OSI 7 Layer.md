# OSI 7 Layer

<br>

계층을 나누는 이유 : 통신이 일어나는 과정을 단계별로 알 수 있고, 이상이 생기게 되면 이상이 생긴 곳을 특정할 수 있게 된다.

계층의 종류는 다음과 같다.

1. 물리
2. 데이터 링크
3. 네트워크
4. 전송
5. 세션
6. 표현
7. 응용

<br>

## 1. Physical Layer : 물리 계층

> **전기적 신호로 변환하여 전송하는 계층**

<br>

- 모든 데이터는 0과 1의 나열이다.
- 0과 1로 이루어진 데이터를 전기 신호로 바꾼 다음 전송하는 기능을 하는 계층이다.
  - 비트 단위의 전송을 한다.
- 따라서 이곳에서는 데이터를 전송하는 역할만 한다.
- 리피터, 케이블, 허브 등의 장비가 물리 계층이다.

<br>

## 2. Data Link Layer : 데이터 링크 계층

> **물리적 매체에 패킷 데이터를 실어 보내는 계층**

<br>

- 물리 계층으로 송수신되는 정보를 관리하여 안전하게 전달되도록 하는 계층이다.
- Mac 주소를 통해서 통신한다.
- 프레임에 Mac 주소를 부여하고 에러 검출, 재전송, 흐름 제어를 진행한다.
  - 프레임 단위의 전송을 한다.
- 브릿지, 스위치 등의 기계들이 데이터 링크 계층에 해당한다.
- 프레이밍이 일어나는 계층이다.
  - 프레이밍(framing) : 1계층에서 주고받는 전기적 신호를 비트화하여 원래 의미로 해석하는 것
- 비트를 전기적 신호로 바꿀 때 비트의 타이밍이 송신측과 수신측 양쪽에서 일치해야 한다.
  - 타이밍을 맞추는 방법으로 동기 방식과 비동기 방식이 있다.
  - 동기 방식
    - clock신호 라는 타이밍을 맞추기 위한 신호를 계속해서 보냄
    - 많이 사용하지는 않는다.
  - 비동기 방식
    - preamble을 사용한다.
      - 지금부터 프레임이 시작된다는 신호
      - 수신측에서 이 프리앰블을 수신하면 그 때부터 프레임 신호가 온다는 것을 판단한다.
      - 프리앰블은 이더넷 프레임의 앞부분에 붙어있다.
    - 패킷 교환 방식에서 일반적으로 사용된다.

<br>

## 3. Network Layer : 네트워크 계층

> **네트워크를 논리적으로 구분하고 연결하는 계층**

<br>

- 라우터가 수행하는 역할이 네트워크 계층에 해당한다.
  - 라우터 : 네트워크간 패킷 전송을 위해 최적의 경로를 설정하며(Routing),
  - 이 경로를 따라 자신 다음의 라우터에게 패킷을 전송하는(forwarding) 장비이다.
    - 패킷 단위의 전송을 한다.
  - 라우터의 종류는 다음과 같다.
    - 코어 라우터
      - 인터넷 서비스 제공자(ISP)의 랜이나 여러 개의 ISP 네트워크를 서로 연결한다.
    - 센터 라우터
      - WAN 회선을 거쳐 회사의 본점과 회사의 지점을 서로 연결한다.
      - 인터넷 서비스 제공자와 기업의 네트워크와 연결할 때에도 쓰인다.
    - 엣지 라우터
      - 지점-지점, 영업소-영업소 등의 네트워크를 WAN 회선에 연결하여 회사의 본점 라우터에 접근한다.
    - 원격 라우터

## 4. Transport Layer : 전송 계층

> **서비스를 구분하고 데이터의 전송 방식을 담당하는 계층**

<br>

- 목적지 시스템과 호스트 간의 데이터 전송을 조율한다.
- 보낼 데이터의 용량, 속도, 목적지 등을 처리한다.
  - 세그먼트 단위로 전송하게 된다.

- 데이터를 보내기 위해 사용하는 프로토콜에는 TCP와 UDP가 있다.

## 4-1. TCP

<br>

TCP : Transmission Control Protocol, 인터넷에서 데이터를 메세지의 형태로 보내기 위해 IP와 함께 사용하는 프로토콜(TCP/IP)

- TCP는 패킷을 추적, 관리 하게 된다

- IP는 데이터의 배달을 처리한다.

- TCP의 특징

  1. 인터넷 환경에서 기본적으로 사용된다.
  2. 연결형 서비스(== 패킷을 전송하기 위한 논리적 경로를 배정)로 높은 신뢰성을 보장한다.
  3. 그렇게 하기 위해 3-way handshaking을 통해 연결을 설정하고 4-way handshaking을 통해 해제한다.
  4. 흐름 제어 및 혼잡 제어가 가능
  5. 그래서 UDP보다 속도가 느리다. (CPU를 사용하기 때문이다)

- 연속성보다 신뢰성이 중요한 전송에 대해 사용하는 프로토콜이다.

  == 패킷이 체계적으로 전송된다.

  == 속도가 느리고 무거운 대신 신뢰성이 높기 때문에 파일 전송과 같은 경우에 사용된다.

- TCP 서버의 특징

  1. 소켓 : 서버 소켓은 연결만을 담당한다.
  2. 연결 함수 : 연결 과정에서 반환된 클라이언트 소켓은 데이터의 송수신에 사용된다.
  3. 연결 형태 : 서버와 클라이언트는 1:1로 연결된다.
  4. 데이터의 크기 : 스트림 전송으로 전송 데이터의 크기가 무제한이다.
  5. 제어 기능의 여부 : 패킷에 대한 응답을 해야하기 때문에 성능이 낮다.

<br>

## 4-2. UDP

<br>

UDP : User Datagram Protocol, 데이터를 데이터그램 단위로 처리하는 프로토콜

- 데이터그램 : 독립적인 관계를 가지는 패킷

- 비 연결형 프로토콜이다.

  == 연결을 위해 할당되는 논리적인 경로가 없다.

  == 각각의 패킷은 서로 다른 경로로 전송된다.

  == 각각의 패킷은 독립적인 관계를 지니게 된다.

- UDP 특징

  1. 정보를 주고 받을 때 정보를 주거나 받는다는 신호절차를 거치지 않고, 비 연결형 서비스로 마구 전송하기 때문에 패킷의 순서를 알 수 없다.
  2. 그래서 패킷의 손실이 있는지 없는지도 알 수 없다. UDP 헤더의 CheckSum 필드를 통해 최소한의 오류만 검출할 뿐이다.
  3. 그래서 신뢰성이 낮다.
  4. 대신 TCP보다 속도가 빠르고 네트워크 부하가 적다.

- 파일 전송과 같은 신뢰성이 필요한 서비스보다 성능이 중요시 되는 경우에 사용된다.

  == 패킷이 체계적으로 전송되지 않고 단지 빠르게 전송시키는 데에만 주력할 뿐이다.

  == 동영상 스트리밍 같은 서비스에 자주 사용된다.

- UDP 서버의 특징

  1. 소켓 : 서버 소켓과 클라이언트 소켓의 구분이 없다.
  2. 연결 함수 : UDP에는 연결 자체가 없어서 connect 함수가 불필요하다.
  3. 연결 형태 : 서버와 클라이언트는 1:1, 1:N, N:M 등으로 연결될 수 있다.
  4. 데이터의 크기 : 데이터그램(message) 단위로 전송되며 그 크기는 65535 byte이고 크기가 커지면 잘라서 보낸다.
  5. 제어 기능의 여부 : 흐름 제어가 없어서 전송 과정에서 문제가 발생해도 오류 여부를 확인할 수 없다.

<br>

---

### 흐름 제어와 혼잡 제어

- 흐름 제어는 데이터를 보내는 곳과 받는 곳의 데이터 처리 속도를 조절한다.
  - 받는 곳의 버퍼 오버플로우를 방지하기 위해서이다.
- 혼잡 제어는 네트워크 내의 패킷 수가 넘치게 증가하지 않도록 방지하는 것이다.
  - 소통량이 많다면 패킷 전송량을 조절하여 혼잡 붕괴 현상이 발생하는 것을 방지한다.

---

### TCP와 UDP 비교

| 프로토콜 종류 | TCP  | UDP  |
| :------: | :-----: | :----: |
|   연결 방식   | 연결형 | 비연결형 |
| 패킷 교환 방식 | 가상 회선 | 데이터 그램 |
| 전송 순서 | 순서를 보장 | 무작위 |
| 수신 여부 확인 |      O      |      X      |
|   통신 방식    |    1 : 1    |  제약 없음  |
|     신뢰성     | 높다 | 낮다 |
| 속도 | 느리다 | 빠르다 |

---

### 네트워크 계층과 전송 계층의 차이

- 네트워크 계층은 호스트 간의 논리적 통신을 돕는다
- 전송 계층은 응용 프로세스 간의 논리적 통신을 돕는다.

---

<br>

## 5. Session Layer : 세션 계층

> **응용 프로그램 간의 연결을 지원해주는 계층**
>
> > 그리고 세션 계층부터는 애플리케이션에 관련된 층이라고 볼 수 있다. (업데이트된 TCP/IP 4 Layer의 경우 기존 OSI 5~7 Layer를 전부 Application Layer로 통합하여 설명하고 있다)

<br>

- Session : 같은 사용자로부터 들어오는 일정 기간동안의 요구들을 하나의 상태로 보고 그 상태를 일정하게 유지하는 기술

  - 일정 기간 : 방문자가 웹 브라우저를 통해 웹 서버에 접속 - 종료하기 까지의 기간

    == 방문자가 웹 서버에 접속해 있는 상태를 하나의 세션이라고 한다.

- 세션 계층 : 두대의 기기 간에 대화가 오고 가기 위하여 세션을 만들어주는 계층

  - 메세지 단위의 전송이 이루어진다.

- 네트워크 양쪽 연결을 관리하고 연결을 지속시켜주는 계층이다.

  - 주로 TCP/IP 세션을 만들고 유지하며, 종료나 전송 중단 시 복구하는 기능이 있다.
  - 통신 연결은 포트 기반으로 구성하여 연결하고, 통신하는 사용자들을 동기화 한다.
  - 운영 체제가 통신을 하기 위한 세션 확립, 유지, 중단 과정을 해 준다.

<br>

## 6. Presentation Layer : 표현 계층

> **데이터의 변환 작업을 하는 계층**

<br>

- 응용 프로그램이나 네트워크를 위해 데이터를 표현하는 계층

  == 코드 간의 번역을 담당한다.

- 응용 계층에서 표현 형식이 서로 다른 데이터들을 다룰 때 생기는 부담을 덜어준다.
- 데이터 표현에 대한 독립성을 제공하고 암호화 하는 역할
- 파일 인코딩, 명령어 포장, 압축, 암호화를 한다.

<br>

## 7. Applications Layer : 응용 계층

> **User Interface를 제공하는 계층**

<br>

- 최종 목적지

- 응용 프로세스와 직접 관계하여 일반적인 응용 서비스를 수행한다.

  == 사용자 또는 애플리케이션이 네트워크에 접근할 수 있게 해준다.

- 사용자 인터페이스, 전자 우편, DB 관리 등의 서비스를 제공한다.

  == 사용자에게 보이는 유일한 계층이다.

- HTTP, FTP, SMTP, POP3, IMAP, Telnet 등과 같은 프로토콜이 있다.
